= Обработка исключений, нарушающих уникальные ограничения

Фреймворк Jmix позволяет настроить сообщение, отображаемое xref:exception-handlers.adoc[обработчиком исключений] при ошибках нарушения ограничений БД.

Кастомное сообщение должно быть указано в xref:localization:message-bundles.adoc[пакете сообщений]. Ключ сообщения должен содержать префикс `databaseUniqueConstraintViolation` плюс уникальное имя индекса базы данных в верхнем регистре. Например:

[source,messages,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/messages.properties[tags=unique-constraint-message]
----

Итак, уведомление по умолчанию выглядит следующим образом:

image::exception-handlers/with-default-exception-message.png[align="center"]

После добавления кастомного ключа сообщения получается следующее уведомление:

image::exception-handlers/with-custom-exception-message.png[align="center"]

Обнаружение ошибок нарушения ограничений БД выполняется классом `UniqueConstraintViolationHandler`, который определяет тип исключения путем поиска специальной маркерной строки в сообщениях всех исключений в цепочке.

Стандратный обработчик также можно полностью заменить, предоставив свой собственный обработчик исключений с более высоким приоритетом, например, `@Order(JmixOrder.HIGHEST_PRECEDENCE - 10)`.