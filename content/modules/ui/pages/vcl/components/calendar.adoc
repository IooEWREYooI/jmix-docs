= Calendar

++++
<div class="backoffice-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=calendar-month" class="live-demo-btn" target="_blank">ДЕМОНСТРАЦИЯ</a>
</div>
++++

Компонент `Calendar` предназначен для организации и отображения событий календаря.

image::vcl/components/calendar-week.png[align="center"]

XML-имя компонента: `calendar`.

[[view-mode]]
== Режим отображения

[[start-end-attributes]]
Календарь имеет 3 режима просмотра, которые выбираются автоматически на основе диапазона дат `calendar`, определяемого атрибутами `startDate` и `endDate`:

1. Месяц - отображается, когда диапазон дат превышает 7 дней.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/calendar/calendar-screen.xml[tags=monthly-view]
----
+
image::vcl/components/calendar-monthly-view.png[align="center"]

2. Неделя - отображается, когда диапазон дат составляет от 1 до 7 дней.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/calendar/calendar-screen.xml[tags=weekly-view]
----
+
image::vcl/components/calendar-weekly-view.png[align="center"]

3. Один день - отображается, когда диапазон дат находится в пределах одного дня.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/calendar/calendar-screen.xml[tags=single-day-view]
----
+
image::vcl/components/calendar-single-day-view.png[align="center"]

[[navigation-buttons-visible]]
`Calendar` в режиме отображения недели или одного дня поддерживает кнопки навигации для перелистывания календаря вперед и назад. По умолчанию они отключены. Чтобы кнопки были видны, установите в атрибуте `navigationButtonsVisible` значение `true`.

[[customization]]
== Настройка

По умолчанию в `calendar` отображаются все 7 дней недели и 24 часа в сутки. Чтобы это изменить, существуют следующие атрибуты:

[[first-and-last-visible-day]]
* `firstVisibleDayOfWeek` и `lastVisibleDayOfWeek` - принимают значения от `1` до `7`, где `1` – это воскресенье, а `7` – Суббота.

[[first-and-last-visible-hour]]
* `firstVisibleHourOfDay` and `lastVisibleHourOfDay` - принимают значения от `1` до `23`, где `1` – это 01:00, а `23` – 23:00.

Например, настроим `calendar` так, чтобы:

1. Отображать только первую половину дня, когда календарь открыт в режиме одного дня.
2. Отображать только вторник и среду на каждой неделе, когда календарь открыт в режиме месяца.

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/calendar/calendar-screen.xml[tags=customized-calendar]
----

image::vcl/components/calendar-customized.gif[align="center"]

[[weekly-caption-format]]
Чтобы изменить названий дней недели, используйте `weeklyCaptionFormat`. Правила класса `https://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html[SimpleDateFormat^]` определяют формат значения `weeklyCaptionFormat`.

[[time-format]]
Чтобы изменить формат времени, используйте атрибут `timeFormat` со следующими возможными значениями:

* `24H`
* `12H` - по умолчанию.

Чтобы изменить названия дней и месяцев, используйте методы `setDayNames()` и `setMonthNames()`, передав в них map с новыми значениями:

[source, java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/calendar/CalendarScreen.java[tags=customized-calendar;init-start;customized-calendar-1;init-end]
----

image::vcl/components/calendar-customized-captions.png[align="center"]

== События Calendar

[[creating-events-programmatically]]
=== Программное создание событий

1. Для отображения событий можно добавлять объекты `SimpleCalendarEvent` в `calendar` при помощи метода `addEvent()` интерфейса `CalendarEventProvider`:
+
[source, java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/calendar/CalendarScreen.java[tags=calendar;init-start;direct-adding;init-end]
----

2. Также можно добавить список объектов `SimpleCalendarEvent` в `calendar` при помощи метода `setEventProvider()`, который принимает объект ListCalendarEventProvider` в качестве параметра.

3. Чтобы удалить события, используйте метод `removeEvent()` или `removeAllEvents()` интерфейса `CalendarEventProvider`.

[[data-aware-events]]
=== События, связанные с данными

Интерфейс `CalendarEventProvider` имеет реализацию `ContainerCalendarEventProvider`, которая позволяет заполнять календарь событиями из сущностей модели данных.

[[property-attributes]]
Чтобы `ContainerCalendarEventProvider` мог использовать сущность, она должна как минимум иметь поля с одним из xref:vcl/components/date-field.adoc#datatype[datatypes] для атрибутов `startDateProperty` и `endDateProperty`, а также поле с типом `String` для атрибута `captionProperty`:

[source, java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/entity/CustomCalendarEvent.java[tags=custom-event]
----

Кроме того, можно определить поля с типом `String` для атрибутов `descriptionProperty` и `stylenameProperty`, а также поле с типом `Boolean` для атрибута `isAllDayProperty`.

Пример использования:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/calendar/calendar-screen.xml[tags=data;layout-start;data-aware-event;layout-end]
----

image::vcl/components/calendar-data-aware.png[align="center"]

[[handlers]]
== События и слушатели

include::../events-hanlers-generation-tip.adoc[]

include::../eventsandhandlers/ContextHelpIconClickEvent.adoc[]

[[calendar-date-click-event]]
=== CalendarDateClickEvent

Данное событие отправляется, когда пользователь нажимает на номер дня месяца.

Программное создание слушателя события: используйте метод компонента `addDateClickListener()`.

[[calendar-event-click-event]]
=== CalendarEventClickEvent

Данное событие отправляется, когда пользователь нажимает на событие.

Программное создание слушателя события: используйте метод компонента `addEventClickListener()`.

[[calendar-event-resize-event]]
=== CalendarEventResizeEvent

Данное событие отправляется, когда пользователь изменяет размер события.

Программное создание слушателя события: используйте метод компонента `addEventResizeListener()`.

[[celendar-event-mode-event]]
=== CalendarEventMoveEvent

Данное событие отправляется, когда пользователь передвигает событие.

Программное создание слушателя события: используйте метод компонента `addEventMoveListener()`.

[[calendar-week-click-event]]
=== CalendarWeekClickEvent

Данное событие отправляется, когда пользователь нажимает на номер недели.

Программное создание слушателя события: используйте метод компонента `addWeekClickListener()`.

[[calendar-forward-click-event]]
=== CalendarForwardClickEvent

Данное событие отправляется, когда пользователь нажимает на кнопку перелистывания вперед.

Программное создание слушателя события: используйте метод компонента `addForwardClickListener()`.

[[calendar-backward-click-event]]
=== CalendarBackwardClickEvent

Данное событие отправляется, когда пользователь нажимает на кнопку перелистывания назад.

Программное создание слушателя события: используйте метод компонента `addBackwardClickListener()`.

[[calendar-range-select-event]]
=== CalendarRangeSelectEvent

Данное событие отправляется, когда пользователь нажимает на пустое место и, не отпуская клавишу, перемещает курсор в другое место.

Программное создание слушателя события: используйте метод компонента `addRangeSelectListener()`.

[[calendar-day-click-event]]
=== CalendarDayClickEvent

Данное событие отправляется, когда пользователь нажимает на пустое место в дне.

Программное создание слушателя события: используйте метод компонента `addDayClickListener()`.

[[styling]]
== Внешний вид

Внешний вид событий календаря можно настроить с помощью CSS. Чтобы настроить стиль, создайте xref:themes/custom_theme.adoc[новую тему], и определите имя стиля с необходимыми параметрами в файле SCSS. Например:

[source,scss,indent=0]
----
include::example$/ex1/src/main/themes/helium-extended/helium-extended.scss[tags=calendar-event-red]
----

Теперь можно задать созданный стиль программно в контроллере экрана:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/calendar/CalendarScreen.java[tags=style-red]
----

Или с помощью атрибута `stylenameProperty`, указав в качестве значения поле сущности, содержащее имя созданного стиля.

[[xml]]
== Все XML-атрибуты

include::../xml-studio-tip.adoc[]

xref:vcl/xml.adoc#align[align] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
<<property-attributes, captionProperty>> -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#data-container[dataContainer] -
xref:vcl/components/date-field.adoc#datatype[datatype] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
<<property-attributes, descriptionProperty>> -
xref:vcl/xml.adoc#enable[enable] -
<<start-end-attributes, endDate>> -
<<property-attributes, endDateProperty>> -
<<first-and-last-visible-day, firstVisibleDayOfWeek>> -
<<first-and-last-visible-hour, firstVisibleHourOfDay>> -
xref:vcl/xml.adoc#height[height] -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
<<property-attributes, isAllDayProperty>>
<<first-and-last-visible-day, lastVisibleDayOfWeek>> -
<<first-and-last-visible-hour, lastVisibleHourOfDay>> -
<<navigation-buttons-visible, navigationButtonsVisible>> -
xref:vcl/xml.adoc#responsive[responsive] -
xref:vcl/xml.adoc#rowspan[rowspan] -
<<start-end-attributes, startDate>> -
<<property-attributes, startDateProperty>> -
xref:vcl/xml.adoc#stylename[stylename] -
<<property-attributes, stylenameProperty>> -
<<time-format, timeFormat>> -
xref:vcl/xml.adoc#visible[visible] -
<<weekly-caption-format, weeklyCaptionFormat>> -
xref:vcl/xml.adoc#width[width]