= FileMultiUploadField
:page-aliases: backoffice-ui:vcl/components/file-multi-upload-field.adoc

`FileMultiUploadField - 多文件上传控件` 支持用户上传文件至临时存储。之后，可以在服务端文件系统以 `File` 对象进行处理或移至 xref:files:index.adoc[文件存储]。

用户点击时，系统自带的文件选择器会弹出，此时用户可以选择多个文件来上传。

image::vcl/components/file-multi-upload-field.gif[align="center"]

组件的 XML 名称：`fileMultiUpload`。

[[basics]]
== 基本用法

示例：

在界面的 XML 描述中声明这个组件：

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/filemultiuploadfield/file-multi-upload-field-screen.xml[tags=file-multi-upload-filed]
----

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/filemultiuploadfield/FileMultiUploadFieldScreen.java[tags=multi]
----

<1> 界面控制器中，注入组件本身以及 `TemporaryStorage` 接口。
<2> 在 `onInit()` 方法里面，添加了事件监听器，这样可以在文件上传成功或者出错时做出反馈。
//todo add link to the clien tier
<3> 该组件将所有选择的文件上传到临时存储并且调用通过 `addQueueUploadCompleteListener()` 方法添加的监听器。
<4> 在这个监听器里面，会调用 `FileMultiUploadField.getUploadsMap()` 方法获得临时存储的文件标识和文件名映射关系的 map。
//todo add link to the FileStorage
<5> 然后，通过调用 `TemporaryStorage.putFileIntoStorage()` 创建相应的 `FileRef` 对象。并且也用这个方法将临时存储的文件移至 FileStorage。
<6> 完成整个上传过程之后，文件列表需要通过调用 `clearUploads()` 方法清空以便下一次上传再使用。

[[listeners]]
== 监听器

`FileMultiUploadField` 组件有下列监听器，均在 `xref:vcl/components/file-storage-upload-field.adoc[FileStorageUploadField]` 组件内介绍：

* `xref:vcl/components/file-storage-upload-field.adoc#file-upload-start-listener[FileUploadStartListener]`
* `xref:vcl/components/file-storage-upload-field.adoc#file-upload-finish-listener[FileUploadFinishListener]`
* `xref:vcl/components/file-storage-upload-field.adoc#file-upload-error-listener[FileUploadErrorListener]`

[[attributes]]
== 属性

`FileMultiUploadField` 组件有如下属性，均在 `xref:vcl/components/file-storage-upload-field.adoc[FileStorageUploadField]` 组件内介绍：

* xref:vcl/components/file-storage-upload-field.adoc#accept[accept]
* xref:vcl/components/file-storage-upload-field.adoc#drop-zone[dropZone]
* xref:vcl/components/file-storage-upload-field.adoc#drop-zone-prompt[dropZonePrompt]
* xref:vcl/components/file-storage-upload-field.adoc#file-size-limit[fileSizeLimit]
* xref:vcl/components/file-storage-upload-field.adoc#paste-zone[pasteZone]
* xref:vcl/components/file-storage-upload-field.adoc#permitted-extensions[permittedExtensions]

[[methods]]
== 方法

* `getUploadsMap()` - 返回 `TemporaryStorage` 中的文件 id 和文件名的映射。
* `clearUploads()` - 清空上传文件列表。

[[xml]]
== FileMultiUploadField XML 属性

xref:vcl/components/file-storage-upload-field.adoc#accept[accept] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/components/file-storage-upload-field.adoc#drop-zone[dropZone] -
xref:vcl/components/file-storage-upload-field.adoc#drop-zone-prompt[dropZonePrompt] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/components/file-storage-upload-field.adoc#file-size-limit[fileSizeLimit] -
xref:vcl/xml.adoc#height[height] -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/components/file-storage-upload-field.adoc#paste-zone[pasteZone] -
xref:vcl/components/file-storage-upload-field.adoc#permitted-extensions[permittedExtensions] -
xref:vcl/xml.adoc#responsive[responsive] -
xref:vcl/xml.adoc#rowspan[rowspan] -
xref:vcl/xml.adoc#stylename[stylename] -
xref:vcl/xml.adoc#tab-index[tabindex] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]
