= ValuePicker

++++
<div class="backoffice-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=valuepicker-actions" class="live-demo-btn" target="_blank">ДЕМОНСТРАЦИЯ</a>
</div>
++++

Компонент `ValuePicker` отображает значение любого типа. Он состоит из текстового поля и набора кнопок, определяемых действиями.

`ValuePicker` является базовым классом для xref:vcl/components/values-picker.adoc[ValuesPicker], xref:vcl/components/entity-picker.adoc[EntityPicker] и xref:vcl/components/entity-combo-box.adoc[EntityComboBox].

XML-имя компонента: `valuePicker`.

== Основы

`ValuePicker` может иметь заголовок и как настраиваемые, так и предопределенные действия:

image::vcl/components/value-picker1.png[align="center"]

Пример определения `ValuePicker` с xref:vcl/xml.adoc#caption[заголовком], полученным из локализованных сообщений, и двумя <<actions,действиями>>:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/valuepicker/valuePicker-screen.xml[tags=valuePicker-1]
----

Что бы создать `ValuePicker`, связанный с данными, используйте атрибуты `dataContainer` и `property`:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/valuepicker/valuePicker-screen.xml[tags=data;valuePicker]
----

В приведенном выше примере экран определяет контейнер данных `userDc` для сущности `User` с атрибутом `login`. В `ValuePicker` атрибут `dataContainer` содержит ссылку на контейнер данных `userDc`, а атрибут `property` включает имя атрибута сущности `login`.

[[fieldEditable]]
По умолчанию пользователь не может ввести значение вручную. Если вы установите для атрибута `fieldEditable` значение `true`, вы включите ручной ввод. Имейте в виду, что введенное значение не соответствует модели данных. Для обработки пользовательского ввода используйте слушатель `FieldValueChangeEvent`.

Рассмотрим пример ниже. У нас есть сущность `User` с атрибутом `age`. Давайте определим `ageValuePicker` в XML-дескрипторе с помощью `fieldEditable="true"`:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/valuepicker/valuePicker-screen.xml[tags=fieldEditable-valuePicker]
----

Теперь пользователь может ввести значение вручную. Чтобы обработать это значение, интерпретируемое как String, подпишитесь на `FieldValueChangeEvent` в контроллере:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/valuepicker/ValuePickerScreen.java[tags=integer-value-picker;field-value-change-event]
----

<1> Получите значение пользовательского ввода в виде строки.
<2> Установите проанализированное значение в `ageValuePicker`.

[[actions]]
== Действия

Вы можете определить пользовательские и предопределенные действия для `ValuePicker`, отображаемые в виде кнопок справа. Это можно сделать либо в XML-дескрипторе, используя вложенный элемент `actions`, либо программно в контроллере, используя метод `addAction()`.

[[predefined-action]]
=== Предопределенное действие

[[clear-action]]
Фреймворком предоставляется только одно предопределенное действие – `value_clear`:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/valuepicker/valuePicker-screen.xml[tags=clearAction]
----
Используйте атрибуты `type` и `id` для объявления предопределенного действия в XML.

Используйте `addAction()`, чтобы установить его программно:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/valuepicker/ValuePickerScreen.java[tags=add-clear-action;onInit-start;add-clear-action1;onInit-end]
----

[[custom-actions]]
=== Пользовательские действия

Чтобы определить пользовательское действие в XML, используйте вложенный элемент `actions`. Укажите атрибуты `id` и `icon` для `action`:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/valuepicker/valuePicker-screen.xml[tags=custom-action]
----

Затем реализуйте пользовательскую логику в контроллере экрана, подписавшись на `Action.ActionPerformedEvent`:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/valuepicker/ValuePickerScreen.java[tags=custom-action-handler]
----

<1> Аннотация `@Subscribe` содержит `id` компонента `ValuePicker` и `id` действия, разделенные точкой.


[[validators-element]]
== Валидация

Для проверки введенных в компонент `ValuePicker` значений можно использовать xref:vcl/miscellaneous/validator.adoc[валидатор] во вложенном элементе `validators`.

[[predefined-validators]]
Для `ValuePicker` доступны следующие предопределенные валидаторы:

* xref:vcl/miscellaneous/validator.adoc#custom-validator[CustomValidator]
* xref:vcl/miscellaneous/validator.adoc#not-null-validator[NotNullValidator]

В приведенном ниже примере показано использование `NotNullValidator` для `countryValidField`:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/entitycombobox/entitycombobox-screen.xml[tags=validator]
----

[[handlers]]
== События и слушатели

include::../events-hanlers-generation-tip.adoc[]

[[context-help-icon-click-handler]]
=== ContextHelpIconClickHandler

См. xref:vcl/api.adoc#context-help-icon-click-handler[ContextHelpIconClickHandler].

[[field-icon-provider]]
=== FieldIconProvider

См.xref:vcl/components/entity-picker.adoc#field-icon-provider[FieldIconProvider].

[[field-value-change-event]]
=== FieldValueChangeEvent

См. <<fieldEditable,FieldValueChangeEvent>>.

[[formatter]]
=== Formatter

См. xref:vcl/components/entity-picker.adoc#formatter[Formatter].

[[validator]]
=== Validator

Добавляет экземпляр xref:vcl/miscellaneous/validator.adoc[validator] к компоненту. Валидатор должен выбросить `ValidationException`, если значение если значение недопустимо.

Если вас не устраивают <<predefined-validators,предопределенные>> валидаторы, добавьте свой собственный экземпляр валидатора:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/combobox/ComboBoxScreen.java[tags=validator]
----

[[value-change-event]]
=== ValueChangeEvent

См. xref:vcl/api.adoc#value-change-event[ValueChangeEvent].

[[xml]]
== XML-атрибуты ValuePicker

include::../xml-studio-tip.adoc[]

xref:vcl/xml.adoc#align[align] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
<<fieldEditable,fieldEditable>> -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/xml.adoc#stylename[stylename] -
xref:vcl/xml.adoc#tab-index[tabIndex] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]

== XML-элементы ValuePicker

<<actions,actions>> -
xref:vcl/miscellaneous/formatter.adoc[formatter] -
<<validators-element,validator>>
