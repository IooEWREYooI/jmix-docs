= Form
:page-aliases: backoffice-ui:vcl/components/form.adoc

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=form-simple" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

//todo add link to GridLayout
`Form - 表单` 组件用于同时展示和编辑实体的多个属性。

组件的 XML 名称：`form`。

[[basics]]
== 基本用法

`Form` 是一个类似于 xref:vcl/containers/grid-layout.adoc[GridLayout] 的简单容器，可以在 XML 中以声明方式定义任意数量的列字段。字段的标题位于字段的左侧。与 `GridLayout` 的主要区别在于 `Form` 能够将所有内部字段绑定到一个 xref:vcl/xml.adoc#data-container[数据容器] 中。

示例：

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/form/form-screen.xml[tags=data-start;order-dc;data-end;layout-start;form-1;layout-end]
----

image::vcl/components/form-1.png[align="center"]

在上面的例子中，`Form` 组件显示了加载到 `orderDc` 数据容器中的实体属性。元素内的定义的可视化组件使用 `property` 这个 XML 属性绑定到实体属性。会根据实体属性的本地化名称自动创建标题。

//todo add link to "component generation strategies - 组件生成策略" - pluggable component factories
除了具体的可视化组件外，表单还能包含用 `field` 元素定义的通用组件。框架会根据相应的实体属性和组件生成策略选择合适的可视化组件。

内部组件可以有多个普通或特殊属性，例如示例中的 `description`。如果要在界面控制器注入内部的组件，可以在 XML 中指定其 `id` 属性。

[[attributes]]
== 属性

[[data-container]]
* `dataContainer` - 为内部字段设置 xref:vcl/xml.adoc#data-container[数据容器]。
[[caption-position]]
* `captionPosition` - 定义字段的标题位置：`TOP` 或 `LEFT`。
[[children-caption-alignment]]
* `childrenCaptionAlignment` - 定义内部所有子组件标题的对齐方式。有两个可选项：`LEFT` 和 `RIGHT`。默认值为 `LEFT`。只有当 `captionPosition` 设置为 `LEFT` 是才有效。
[[children-caption-width]]
* `childrenCaptionWidth` - 为所有内部列及其子元素指定固定标题宽度。设置 `-1` 使用自动大小。
[[rowspan]] [[colspan]]
* `colspan` 和 `rowspan`：
+
`Form` 组件支持 `colspan` 和 `rowspan` 属性。这些属性用来设置对应的内部组件占据的列数和行数。下面的例子演示 `Field 1` 如何占据两列：
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/form/form-screen.xml[tags=layout-start;form-2;layout-end]
----
+
image::vcl/components/form-2.png[align="center"]
+
类似的，`Field 1` 也可以扩展至两行：
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/form/form-screen.xml[tags=layout-start;form-3;layout-end]
----
+
image::vcl/components/form-3.png[align="center"]

[[methods]]
== 方法

* `setChildrenCaptionAlignment(CaptionAlignment alignment)` - 设置所有列中子组件的标题对齐方式。
* `setChildrenCaptionAlignment(int column, CaptionAlignment alignment)` - 设置给定 index 列的子组件标题对齐方式。
* `add()` - 支持以编程的方式为 `Form` 增加字段：
+
它接收一个 `Component` 实例作为参数，也可以通过添加 `column` 和 `row` 索引来定义新字段的位置。另外，还有一个重载方法可以使用 `rowspan` 和 `colspan` 作为参数。
+
框架不会为使用编程方式添加的组件指定数据容器，所以需要使用 `setValueSource()` 方法进行数据绑定。
+
示例：
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/form/form-screen.xml[tags=data-start;customer-dc;data-end;layout-start;form-4;layout-end]
----
+
如下例所示，可以在界面控制器中使用编程的方式添加 `email` 字段：
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/form/FormScreen.java[tags=form]
----

[[column-elements]]
== Column 元素

`Column` 是一个可选元素，支持将字段按多列放置。为此，内部字段不应该直接放在 `form` 元素中，而应放在 `column` 中。示例：

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/form/form-screen.xml[tags=layout-start;form-5;layout-end]
----

在这种情况下，字段将排列成两列; 第一列所有字段的宽度为 `250px`，第二列所有字段的宽度为 `400px`。

image::vcl/components/form-5.png[align="center"]

[[column-attributes]]
=== Column 属性

//todo add link to screen extension
* `id` - 一个可选的列标识符，支持在扩展界面时引用。
* `width` - 指定列的字段宽度。默认情况下，字段的宽度为 `200px`。在此属性中，支持以像素为单位指定宽度，也支持以列的水平宽度的百分比指定宽度。
* `childrenCaptionWidth` - 为内部字段指定固定的标题宽度。设置 `-1` 使用自动大小。
* `childrenCaptionAlignment` - 定义内嵌字段标题的对齐方式。有两个可选项：`LEFT` 和 `RIGHT`。默认值为 `LEFT`。只有当 `<<caption-position, captionPosition>>` 设置为 `LEFT` 是才有效。

[[xml]]
== XML 属性

xref:vcl/xml.adoc#align[align] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
<<caption-position, captionPosition>> -
<<children-caption-alignment, childrenCaptionAlignment>> -
<<children-caption-width, childrenCaptionWidth>> -
<<colspan, colspan>> -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
xref:vcl/xml.adoc#css[css] -
<<data-container, dataContainer>> -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/xml.adoc#editable[editable] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#height[height] -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/xml.adoc#responsive[responsive] -
<<rowspan, rowspan>> -
xref:vcl/xml.adoc#stylename[stylename] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]
