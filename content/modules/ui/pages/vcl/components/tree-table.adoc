= TreeTable
:page-aliases: backoffice-ui:vcl/components/tree-table.adoc

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=treetable-simple" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`TreeTable - 树形表格` 组件是在最左列显示一个"树结构"的具有层级关系的表格。这个组件用于具有自引用关系的 xref:data-model:entities.adoc[实体]。比如，产品目录结构或公司的组织结构图。

组件的 XML 名称：`treeTable`。

== 基本用法

`TreeTable` 功能基本上与 xref:vcl/components/table.adoc[Table] 组件一致。

典型的树形表格如下：

image::vcl/components/tree-table-simple.png[align="center"]

. 树列
. 展开和折叠树节点的开关

`TreeTable` 组件的 xref:vcl/xml.adoc#data-container[dataContainer] 属性指向一个 xref:data/collection-container.adoc[集合数据容器]。

[[hierarchy-property]]
`hierarchyProperty` 属性定义引用自身实体属性的名称。

在界面 XML 描述中定义的组件示例：

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/treetable/treeTable-screen.xml[tags=data-start;data-departmentsDc;data-end;layout-start;tree-table;layout-end;]
----

CAUTION: `TreeTable` 会一次性的渲染数据容器中的所有数据，因此不要用于展示大量数据的场景。

[[show-orphans]]
== 孤立记录

孤立记录是指不存在的父记录的子记录。通常这是由于过滤或分页，导致从数据库中仅加载了部分数据造成的。


`showOrphans` 属性用来控制是否在树形组件中显示孤立记录。如果设置为 `false`，则组件不会显示孤立记录。否则，孤立记录会作为树的顶层根节点展示。

默认值为 `true`。

在使用 xref:vcl/components/filter.adoc[过滤器] 时，隐藏孤立记录更符合人们的习惯。但是，这样会导致分页有问题，某些页可能是空的或者只有一半数据，所以在使用树形组件时，最好不要使用 xref:vcl/components/pagination.adoc[Pagination] 和 xref:vcl/components/simple-pagination.adoc[SimplePagination] 组件。

== 列值导出

参阅 `Table` 组件的 xref:vcl/components/table.adoc#exporting-column-values[列值导出] 章节。

== TreeTable 接口方法

[[methods-expand-all]]
* `expandAll()` - 展开所有节点

[[methods-expand]]
* `expand()` - 展开树中所有比当前节点级别高的节点。

[[methods-collapse-all]]
* `collapseAll()` - 折叠所有节点

[[methods-collapse]]
* `collapse()` - 折叠树中所有比当前节点级别低的节点。

[[methods-expand-up-to]]
* `expandUpTo()` - 自根节点开始，展开直至指定级别的所有节点。方法接收一个参数：需要展开 `TreeTable` 节点的级别。如果传入 `level = 1`，则仅展开根节点。
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/treetable/TreeTableScreen.java[tags=expand-up-to]
----
+
image::vcl/components/tree-table-expand-up-to.png[align="center"]

[[methods-is-expanded]]
* `isExpanded()` - 返回指定 `itemId` 的节点是否展开。如果展开则返回 `true`，其他情况返回 `false`。

== 事件和处理器

include::../events-hanlers-generation-tip.adoc[]

[[aggregation-distribution-provider]]
=== AggregationDistributionProvider

参阅 xref:vcl/components/table.adoc#aggregation-distribution-provide。[AggregationDistributionProvider].

[[column-collapse-event]]
=== ColumnCollapseEvent

参阅 xref:vcl/components/table.adoc#column-collapse-event[ColumnCollapseEvent]。

[[column-reorder-event]]
=== ColumnReorderEvent

参阅 xref:vcl/components/table.adoc#column-reorder-event[ColumnReorderEvent]。

[[context-help-icon-click-handler]]
=== ContextHelpIconClickHandler

参阅 xref:vcl/api.adoc#context-help-icon-click-handler[ContextHelpIconClickHandler]。

[[empty-state-link-click-handler]]
=== EmptyStateLinkClickHandler

参阅 xref:vcl/components/table.adoc#empty-state-click-event[EmptyStateClickEvent]。

[[icon-provider]]
=== IconProvider

参阅 xref:vcl/components/table.adoc#icon-provider[IconProvider]。

[[item-description-provider]]
=== ItemDescriptionProvider

参阅 xref:vcl/components/table.adoc#item-description-provider[ItemDescriptionProvider]。

[[lookup-select-handler]]
=== LookupSelectHandler

参阅 xref:vcl/components/table.adoc#lookup-select-handler[LookupSelectHandler]。

[[selection-event]]
=== SelectionEvent

参阅 xref:vcl/components/table.adoc#selection-event[SelectionEvent]。

[[style-provider]]
=== StyleProvider

参阅 xref:vcl/components/table.adoc#style-provider[StyleProvider]。

[[xml]]
== XML 属性

include::../xml-studio-tip.adoc[]

=== TreeTable XML 属性
xref:vcl/components/table.adoc#aggregatable[aggregatable] -
xref:vcl/components/table.adoc#aggregation-style[aggregationStyle] -
xref:vcl/xml.adoc#align[align] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/components/table.adoc#column-control-visible[columnControlVisible] -
xref:vcl/components/table.adoc#column-header-visible[columnHeaderVisible] -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
xref:vcl/components/table.adoc#context-menu-enabled[contextMenuEnabled] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#data-container[dataContainer] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/components/table.adoc#editable[editable] -
xref:vcl/components/table.adoc#empty-state-link-message[emptyStateLinkMessage] -
xref:vcl/components/table.adoc#empty-state-message[emptyStateMessage] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#height[height] -
<<hierarchy-property,hierarchyProperty>> -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/components/table.adoc#meta-class[metaClass] -
xref:vcl/components/table.adoc#multi-line-cells[multiLineCells] -
xref:vcl/components/table.adoc#multiselect[multiselect] -
xref:vcl/components/table.adoc#reordering-allowed[reorderingAllowed] -
xref:vcl/xml.adoc#responsive[responsive] -
xref:vcl/xml.adoc#rowspan[rowspan] -
<<show-orphans,showOrphans>> -
xref:vcl/components/table.adoc#show-selection[showSelection] -
xref:vcl/components/group-table.adoc#show-total-aggregation[showTotalAggregation] -
xref:vcl/components/table.adoc#table-sorting[sortable] -
xref:vcl/components/table.adoc#stylename[stylename] -
xref:vcl/xml.adoc#tab-index[tabIndex] -
xref:vcl/components/table.adoc#text-selection-enabled[textSelectionEnabled] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]

[[xml-tree-table-elements]]
=== TreeTable XML 元素

xref:vcl/components/table.adoc#actions[actions] -
xref:vcl/components/table.adoc#buttons-panel[buttonsPanel] -
xref:vcl/components/table.adoc#columns[columns] -
xref:vcl/components/table.adoc#paging[simplePagination]

=== Columns XML 属性

xref:vcl/components/table.adoc#exclude[exclude] -
xref:vcl/components/table.adoc#include-all[include-all]

=== Column XML 属性

xref:vcl/components/table.adoc#column-alignment[align] -
xref:vcl/components/table.adoc#column-caption[caption] -
xref:vcl/components/table.adoc#column-caption-as-html[captionAsHtml] -
xref:vcl/components/table.adoc#caption-property[captionProperty] -
xref:vcl/components/table.adoc#column-collapsed[collapsed] -
xref:vcl/components/table.adoc#column-date-format-resolution[dateFormat] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/components/table.adoc#column-editable[editable] -
xref:vcl/components/table.adoc#column-expand-ratio[expandRatio] -
xref:vcl/components/table.adoc#column-id[id] -
xref:vcl/components/table.adoc#column-link[link] -
xref:vcl/components/table.adoc#column-link-screen-id[linkScreenId] -
xref:vcl/components/table.adoc#column-link-screen-open-mode[linkScreenOpenMode] -
xref:vcl/components/table.adoc#column-max-text-length[maxTextLength] -
xref:vcl/components/table.adoc#column-options-container[optionsContainer] -
xref:vcl/xml.adoc#required[required] -
xref:vcl/xml.adoc#required-message[requiredMessage] -
xref:vcl/components/table.adoc#column-date-format-resolution[resolution] -
xref:vcl/components/table.adoc#column-sort[sort] -
xref:vcl/components/table.adoc#column-sortable[sortable] -
xref:vcl/components/table.adoc#column-visible[visible] -
xref:vcl/components/table.adoc#column-width[width]

=== Column XML 元素

xref:vcl/components/table.adoc#aggregatable[aggregation] -
xref:vcl/components/table.adoc#column-formatter[formatter]

=== Aggregation XML 属性

xref:vcl/components/table.adoc#aggregation-editable[editable] -
xref:vcl/components/table.adoc#aggregation-strategy-class[strategyClass] -
xref:vcl/components/table.adoc#aggregation-type[type] -
xref:vcl/components/table.adoc#aggregation-value-description[valueDescription]

=== Aggregation XML 元素

xref:vcl/components/table.adoc#aggregation-formatter[formatter]

== API

<<methods-collapse,collapse>> -
<<methods-collapse-all,collapseAll>> -
<<methods-expand,expand>> -
<<methods-expand-all,expandAll>> -
<<methods-expand-up-to,expandUpTo>> -
xref:vcl/components/table.adoc#methods-get-aggregation-results[getAggregationResults] -
<<methods-is-expanded,isExpanded>> -
xref:vcl/components/table.adoc#methods-get-selected[getSelected] -
xref:vcl/components/table.adoc#methods-get-selected[getSingleSelected] -
xref:vcl/components/table.adoc#methods-request-focus[requestFocus] -
xref:vcl/components/table.adoc#methods-scroll-to[scrollTo] -
xref:vcl/components/table.adoc#methods-set-enter-press-action[setEnterPressAction] -
xref:vcl/components/table.adoc#methods-set-item-click-action[setItemClickAction]
