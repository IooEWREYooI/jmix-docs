= TreeTable

++++
<div class="backoffice-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=treetable-simple" class="live-demo-btn" target="_blank">ДЕМОНСТРАЦИЯ</a>
</div>
++++

`TreeTable` представляет собой иерархическую таблицу для отображения древовидной структуры в крайнем левом столбце. Компонент используется для xref:data-model:entities.adoc[сущностей], которые имеют ссылки на самих себя. Например, это может быть структура каталога продукции или организационная структура компании.

XML-имя компонента: `treeTable`.

== Основы

`TreeTable` в основном повторяет функциональность компонента xref:vcl/components/table.adoc[Table].

Ниже представлен типичный `TreeTable`:

image::vcl/components/tree-table-simple.png[align="center"]

. Столбец дерева
. Переключатели для развертывания и свертывания узлов

Атрибут xref:vcl/xml.adoc#data-container[dataContainer] компонента `TreeTable` должен содержать ссылку на  xref:data/collection-container.adoc[контейнер коллекции].

[[hierarchy-property]]
Атрибут `hierarchyProperty` определяет имя атрибута сущности, которая ссылается на ту же сущность.

Ниже приведен пример описания компонента в XML-дескрипторе экрана:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/treetable/treeTable-screen.xml[tags=data-start;data-departmentsDc;data-end;layout-start;tree-table;layout-end;]
----

CAUTION: `TreeTable` отображает сразу все записи, доступные в контейнере данных, поэтому его не следует использовать для отображения большого объема данных.

[[show-orphans]]
== Потерянные записи

Потерянная запись (orphan record) — это дочерняя запись, которая ссылается на несуществующую родительскую запись. Обычно это происходит при загрузке только части данных из базы данных из-за фильтрации или разбивки на страницы.

Атрибут `showOrphans` используется для управления видимостью потерянных записей. Если установлено значение `false`, компонент не отображает потерянные записи. Если `showOrphans` установлен в  `true`, потерянные записи отображаются на верхнем уровне как корневые.

Значение по умолчанию – `true`.

Не показывать потерянные записи кажется естественным выбором при использовании xref:vcl/components/filter.adoc[фильтров]. Однако это не помогает при разбивке на страницы (некоторые страницы будут пустыми или заполнены наполовину). Поэтому не следует использовать компоненты xref:vcl/components/pagination.adoc[Pagination] и xref:vcl/components/simple-pagination.adoc[SimplePagination] вместе с древовидными компонентами.

== Экспорт значений колонок

См. соответсвующий xref:vcl/components/table.adoc#exporting-column-values[раздел] для компонента `Table`.

== Методы интерфейса TreeTable

[[methods-expand-all]]
* `expandAll()` - разворачивает все узлы.

[[methods-expand]]
* `expand()` - разворачивает все узлы, находящиеся выше по уровню данного элемента.

[[methods-collapse-all]]
* `collapseAll()` - сворачивает все узлы.

[[methods-collapse]]
* `collapse()` - сворачивает все узлы, находящиеся ниже по уровню, чем данный элемент.

[[methods-expand-up-to]]
* `expandUpTo()` - расширяет все узлы от корня до указанного уровня. Принимает один параметр: уровень узлов `TreeTable` для расширения. Если уровень = 1, то корневые предметы будут расширены.
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/treetable/TreeTableScreen.java[tags=expand-up-to]
----
+
image::vcl/components/tree-table-expand-up-to.png[align="center"]

[[methods-is-expanded]]
* `isExpanded()` -  возвращает, является ли элемент с данным `itemId` развернутым или свернутым. Метод возвращает значение `true`, если элемент развернут, и `false` в противном случае.

== События и слушатели

include::../events-hanlers-generation-tip.adoc[]

[[aggregation-distribution-provider]]
=== AggregationDistributionProvider

См. xref:vcl/components/table.adoc#aggregation-distribution-provider[AggregationDistributionProvider].

[[column-collapse-event]]
=== ColumnCollapseEvent

См. xref:vcl/components/table.adoc#column-collapse-event[ColumnCollapseEvent].

[[column-reorder-event]]
=== ColumnReorderEvent

См. xref:vcl/components/table.adoc#column-reorder-event[ColumnReorderEvent].

[[context-help-icon-click-handler]]
=== ContextHelpIconClickHandler

См. xref:vcl/api.adoc#context-help-icon-click-handler[ContextHelpIconClickHandler].

[[empty-state-link-click-handler]]
=== EmptyStateLinkClickHandler

См. xref:vcl/components/table.adoc#empty-state-click-event[EmptyStateClickEvent].

[[icon-provider]]
=== IconProvider

См. xref:vcl/components/table.adoc#icon-provider[IconProvider].

[[item-description-provider]]
=== ItemDescriptionProvider

См. xref:vcl/components/table.adoc#item-description-provider[ItemDescriptionProvider].

[[lookup-select-handler]]
=== LookupSelectHandler

См. xref:vcl/components/table.adoc#lookup-select-handler[LookupSelectHandler].

[[selection-event]]
=== SelectionEvent

См. xref:vcl/components/table.adoc#selection-event[SelectionEvent].

[[style-provider]]
=== StyleProvider

См. xref:vcl/components/table.adoc#style-provider[StyleProvider].

[[xml]]
== Все XML-атрибуты

include::../xml-studio-tip.adoc[]

=== XML-атрибуты TreeTable
xref:vcl/components/table.adoc#aggregatable[aggregatable] -
xref:vcl/components/table.adoc#aggregation-style[aggregationStyle] -
xref:vcl/xml.adoc#align[align] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/components/table.adoc#column-control-visible[columnControlVisible] -
xref:vcl/components/table.adoc#column-header-visible[columnHeaderVisible] -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
xref:vcl/components/table.adoc#context-menu-enabled[contextMenuEnabled] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#data-container[dataContainer] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/components/table.adoc#editable[editable] -
xref:vcl/components/table.adoc#empty-state-link-message[emptyStateLinkMessage] -
xref:vcl/components/table.adoc#empty-state-message[emptyStateMessage] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#height[height] -
<<hierarchy-property,hierarchyProperty>> -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/components/table.adoc#meta-class[metaClass] -
xref:vcl/components/table.adoc#multi-line-cells[multiLineCells] -
xref:vcl/components/table.adoc#multiselect[multiselect] -
xref:vcl/components/table.adoc#reordering-allowed[reorderingAllowed] -
xref:vcl/xml.adoc#responsive[responsive] -
xref:vcl/xml.adoc#rowspan[rowspan] -
<<show-orphans,showOrphans>> -
xref:vcl/components/table.adoc#show-selection[showSelection] -
xref:vcl/components/group-table.adoc#show-total-aggregation[showTotalAggregation] -
xref:vcl/components/table.adoc#table-sorting[sortable] -
xref:vcl/components/table.adoc#stylename[stylename] -
xref:vcl/xml.adoc#tab-index[tabIndex] -
xref:vcl/components/table.adoc#text-selection-enabled[textSelectionEnabled] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]

[[xml-tree-table-elements]]
=== XML-элементы TreeTable

xref:vcl/components/table.adoc#actions[actions] -
xref:vcl/components/table.adoc#buttons-panel[buttonsPanel] -
xref:vcl/components/table.adoc#columns[columns] -
xref:vcl/components/table.adoc#paging[simplePagination]

=== XML-атрибуты Columns

xref:vcl/components/table.adoc#exclude[exclude] -
xref:vcl/components/table.adoc#include-all[include-all]

=== XML-атрибуты Column

xref:vcl/components/table.adoc#column-alignment[align] -
xref:vcl/components/table.adoc#column-caption[caption] -
xref:vcl/components/table.adoc#column-caption-as-html[captionAsHtml] -
xref:vcl/components/table.adoc#caption-property[captionProperty] -
xref:vcl/components/table.adoc#column-collapsed[collapsed] -
xref:vcl/components/table.adoc#column-date-format-resolution[dateFormat] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/components/table.adoc#column-editable[editable] -
xref:vcl/components/table.adoc#column-expand-ratio[expandRatio] -
xref:vcl/components/table.adoc#column-id[id] -
xref:vcl/components/table.adoc#column-link[link] -
xref:vcl/components/table.adoc#column-link-screen-id[linkScreenId] -
xref:vcl/components/table.adoc#column-link-screen-open-mode[linkScreenOpenMode] -
xref:vcl/components/table.adoc#column-max-text-length[maxTextLength] -
xref:vcl/components/table.adoc#column-options-container[optionsContainer] -
xref:vcl/xml.adoc#required[required] -
xref:vcl/xml.adoc#required-message[requiredMessage] -
xref:vcl/components/table.adoc#column-date-format-resolution[resolution] -
xref:vcl/components/table.adoc#column-sort[sort] -
xref:vcl/components/table.adoc#column-sortable[sortable] -
xref:vcl/components/table.adoc#column-visible[visible] -
xref:vcl/components/table.adoc#column-width[width]

=== XML-элементы Column

xref:vcl/components/table.adoc#aggregatable[aggregation] -
xref:vcl/components/table.adoc#column-formatter[formatter]

=== XML-атрибуты Aggregation

xref:vcl/components/table.adoc#aggregation-editable[editable] -
xref:vcl/components/table.adoc#aggregation-strategy-class[strategyClass] -
xref:vcl/components/table.adoc#aggregation-type[type] -
xref:vcl/components/table.adoc#aggregation-value-description[valueDescription]

=== XML-элемент агрегации

xref:vcl/components/table.adoc#aggregation-formatter[formatter]

== API

<<methods-collapse,collapse>> -
<<methods-collapse-all,collapseAll>> -
<<methods-expand,expand>> -
<<methods-expand-all,expandAll>> -
<<methods-expand-up-to,expandUpTo>> -
xref:vcl/components/table.adoc#methods-get-aggregation-results[getAggregationResults] -
<<methods-is-expanded,isExpanded>> -
xref:vcl/components/table.adoc#methods-get-selected[getSelected] -
xref:vcl/components/table.adoc#methods-get-selected[getSingleSelected] -
xref:vcl/components/table.adoc#methods-request-focus[requestFocus] -
xref:vcl/components/table.adoc#methods-scroll-to[scrollTo] -
xref:vcl/components/table.adoc#methods-set-enter-press-action[setEnterPressAction] -
xref:vcl/components/table.adoc#methods-set-item-click-action[setItemClickAction]