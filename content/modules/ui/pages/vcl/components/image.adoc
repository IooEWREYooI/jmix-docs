= Image
:page-aliases: backoffice-ui:vcl/components/image.adoc

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=image-url" class="live-demo-btn" target="_blank">LIVE DEMO</a>
</div>
++++

Компонент `Image` предназначен для отображения графического содержимого из различных источников. Компонент можно привязать к xref:vcl/xml.adoc#data-container[контейнеру данных] или сконфигурировать программно.

XML-имя компонента: `image`.

[[basics]]
== Основы

Компонент `Image` может отображать значение атрибута сущности с типом `FileRef` или `byte[]`.

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/entity/Person.java[tags=file-storage-upload-field]
----

В простейшем случае, компонент можно связать с данными с помощью XML-атрибутов xref:vcl/xml.adoc#data-container[dataContainer] и xref:vcl/xml.adoc#property[property]:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=data-start;instance;data-end;layout-start;simple-image;layout-end]
----

В данном случае компонент отображает атрибут `image` сущности `Person`, находящейся в контейнере данных `personDc`.

[[resources]]
== Ресурсы

Помимо источников данных, компонент `Image` может использовать в качестве источника содержимого различные типы ресурсов. Тип ресурса можно указать декларативно с помощью элементов `image`, перечисленных ниже:

[[resource-classpath]]
* `classpath` - ресурс, расположенный в classpath по заданному в `path` пути.
+
For example, if your resource has the following path: `"ui/ex1/screen/component/image/jmix-logo.png"`, you can set the resource type declaratively:
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=classpath]
----

[[resource-file]]
* `file` - a resource that is stored in the file system as the given `File`. For example:
+
[source,xml,indent=0]
----
            <image>
                <resource>
                    <file path="D:\JMIX\jmix-logo.png"/>
                </resource>
            </image>
----

[[resource-relative-path]]
* `relativePath` - a resource that is stored in the directory of the deployed application.
+
To get access to a file using the relative path resource approach, you should create a `VAADIN` folder in the root of the `resource` directory. Files stored in this directory are accessible via URL.
+
image::vcl/components/image-relative-path.png[align="center"]
+
Then you can set the resource type declaratively, for example:
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=relative-path]
----
+
The generated URL for a relative path will be `++http://localhost:8080/VAADIN/images/jmix-icon-login.svg++`.

[[resource-theme]]
* `theme` - a xref:themes.adoc[theme] resource. For example, for the `helium-ext` custom theme, you can create the `images` directory with resources:
+
image::vcl/components/images-theme-resources.png[align="center"]
+
Then set the path to your resource declaratively, for example:
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=theme-resource]
----

[[resource-url]]
* `url` - resource which can be loaded from the given URL.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=url-resource]
----

Также это можно сделать программно, используя один из <<resource-types,типов ресурсов>>.

[[resource-settings]]
=== Настройки ресурсов

* `bufferSize` - размер буфера, используемого для загрузки этого ресурса, в байтах.
* `cacheTime` - время хранения объекта в кэше в миллисекундах.
* `mimeType` - MIME-тип ресурса.

Например:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=mime]
----

[[attributes]]
== Атрибуты

[[alternate-text]]
* `alternateText` - устанавливает альтернативный текст на случай, если ресурс недоступен или не задан.

[[scale-mode]]
* `scaleMode` - устанавливает режим масштабирования изображения. Доступны следующие режимы:
** `FILL` - изображение масштабируется, чтобы заполнить всю область компонента: используется вся ширина и высота компонента.
** `CONTAIN` - изображение подстраивается под размер компонента с сохранением пропорций, уменьшаясь или растягиваясь по меньшей стороне компонента.
** `COVER` - изображение масштабируется так, чтобы заполнить всю область компонента, сохраняя при этом соотношения сторон. Если пропорции изображения не совпадают с пропорциями компонента, то изображение будет обрезано по размеру.
** `SCALE_DOWN` - изображение изменяет размер, сравнивая разницу между `NONE` и `CONTAIN`, для того, чтобы найти наименьший конкретный размер объекта.
** `NONE` - изображение сохранит свой исходный размер, размер компонента будет равен размеру изображения.

[[methods]]
== Методы

Для программного управления компонентом `Image` следует использовать следующие методы:

* `setValueSource()` - устанавливает для изображения контейнер данных и его атрибут. Поддерживаются только атрибуты типов `FileRef` и `byte[]`.
+
Программное указание контейнера данных позволяет, к примеру, отображать изображения в ячейках таблицы:
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=data-start;collection;data-end;layout-start;group-table;layout-end]
----
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageScreen.java[tags=value-source]
----

* `setSource()` - устанавливает источник изображения. Метод принимает тип ресурса и возвращает объект ресурса, который может быть сконфигурирован далее.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=layout-start;programmatic-image;layout-end]
----
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageScreen.java[tags=set-source]
----

[[resource-types]]
=== Типы ресурсов

Можно использовать следующие типы ресурсов, реализующие интерфейс `Resource`, или расширить их:

* `ClasspathResource` - для изображений, хранимых в classpath.
* `FileResource` - для изображений, хранимых в файловой системе.
* `FileStorageResource` - для изображений из xref:files:file-storage.adoc[хранилища данных].
* `RelativePathResource` - для изображений, хранимых в каталоге приложения.
* `StreamResource` - для изображений, получаемых из потока.
* `ThemeResource` - для изображений темы, например, `VAADIN/themes/yourtheme/some/path/image.png`.
* `UrlResource` - для изображений, загружаемых по указанному URL.

[[handlers]]
== События и слушатели

include::../events-hanlers-generation-tip.adoc[]

[[click-event]]
=== ClickEvent

См. xref:vcl/components/button.adoc#click-event[ClickEvent].

[[context-help-icon-click-event]]
=== ContextHelpIconClickEvent

См. xref:vcl/api.adoc#context-help-icon-click-handler[ContextHelpIconClickEvent].

[[source-change-event]]
=== SourceChangeEvent

`SourceChangeEvent` отправляется при изменении источника изображения и имеет следующие методы:

* `getNewSource()`
* `getOldSource()`

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageScreen.java[tags=source-change-event]
----

Чтобы создать слушателя события программно, используйте метод компонента  `addSourceChangeListener()`.

[[xml]]
== Все XML-атрибуты

include::../xml-studio-tip.adoc[]

=== Image XML Attributes

xref:vcl/xml.adoc#align[align] -
<<alternate-text, alternateText>> -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#data-container[dataContainer] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/xml.adoc#editable[editable] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#height[height] -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/xml.adoc#property[property] -
xref:vcl/xml.adoc#required[required] -
xref:vcl/xml.adoc#required-message[requiredMessage] -
xref:vcl/xml.adoc#property[property] -
xref:vcl/xml.adoc#required[required] -
xref:vcl/xml.adoc#required-message[requiredMessage] -
xref:vcl/xml.adoc#rowspan[rowspan] -
<<scale-mode, scaleMode>> -
xref:vcl/xml.adoc#stylename[stylename] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]

=== Image XML Elements

<<resources,resource>>

=== Resources XML Elements

<<resource-classpath,classpath>> -
<<resource-file,file>> -
<<resource-relative-path,relativePath>> -
<<resource-theme,theme>> -
<<resource-url,url>>