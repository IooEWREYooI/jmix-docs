= Image
:page-aliases: backoffice-ui:vcl/components/image.adoc

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=image-url" class="live-demo-btn" target="_blank">LIVE DEMO</a>
</div>
++++

Компонент `Image` предназначен для отображения графического содержимого из различных источников. Компонент можно привязать к xref:vcl/xml.adoc#data-container[контейнеру данных] или сконфигурировать программно.

XML-имя компонента: `image`.

[[basics]]
== Основы

Компонент `Image` может отображать значение атрибута сущности с типом `FileRef` или `byte[]`. В приведенном ниже примере сущность имеет атрибут `image`, который является ссылкой на файл в xref:files:file-storage.adoc[файловом хранилище]:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/entity/Person.java[tags=file-storage-upload-field]
----

В простейшем случае, компонент можно связать с данными с помощью XML-атрибутов xref:vcl/xml.adoc#data-container[dataContainer] и xref:vcl/xml.adoc#property[property]:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=data-start;instance;data-end;layout-start;simple-image;layout-end]
----

В данном случае компонент отображает атрибут `image` сущности `Person`, находящейся в контейнере данных `personDc`.

[[resources]]
== Ресурсы

Помимо источников данных, компонент `Image` может использовать в качестве источника содержимого различные типы ресурсов. Тип ресурса можно указать декларативно с помощью элементов `image`, или программно с помощью метода `setSource()`.

[[rclasspath-resource]]
=== ClasspathResource

Ресурс, расположенный в classpath.

* В XML: элемент `classpath` с атрибутом `path`.
+
Например, если изображение находится в `ui/ex1/screen/component/image/jmix-logo.png` под `src/main/resources`, отображаемый ресурс можно указать следующим образом:
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=classpath]
----

* На Java: интерфейс `ClasspathResource`.
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageResourceScreen.java[tags=image-classpath]
----

[[file-resource]]
=== FileResource

Ресурс, хранимый в файловой системе сервера.

* В XML: элемент `file` с атрибутом `path`.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=file-resource]
----

* На Java: интерфейс `FileResource`.
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageResourceScreen.java[tags=image-file-resource]
----

[[file-storage-resource]]
=== FileStorageResource

Изображение, находящееся в xref:files:file-storage.adoc[хранилище файлов].

* В XML: атрибут `property` у `image`.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=simple-image]
----

* В Java: интерфейс `FileStorageResource`.
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageResourceScreen.java[tags=image-file-storage-resource]
----

[[relative-path-resource]]
=== RelativePathResource

Изображение, статически обслуживаемое приложением.

По умолчанию статическое содержимое передается из каталогов classpath `/static`, `/public`, `/resources`, или `/META-INF/resources` (подробности см. в https://docs.spring.io/spring-boot/docs/current/reference/html/web.html#web.servlet.spring-mvc.static-content[документации Spring Boot^]).

* В XML: элемент `relativePath` с атрибутом `path`.
+
Например, изображение, расположенное по адресу `src/main/resources/static/images/jmix-icon-login.svg`, может отображаться следующим образом:
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=relative-path]
----
+
Изображение также будет доступно по адресу `++http://{host}:{port}/images/jmix-icon-login.svg++`.

* В Java: интерфейс `RelativePathResource`.
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageResourceScreen.java[tags=image-relative-path]
----

[[stream-resource]]
=== StreamResource

Изображение, предоставленное в `InputStream`.

* В Java: интерфейс `StreamResource`.
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageResourceScreen.java[tags=image-stream]
----

[[theme-resource]]
=== ThemeResource

Изображение, расположенное в текущей xref:themes.adoc[теме].

В приведенном ниже примере изображение находится в каталоге `images` нестандартной темы `helium-ext`:

image::vcl/components/images-theme-resources.png[align="center"]

Затем его можно использовать в компоненте `Image` следующим образом:

* В XML: элемент `theme` с атрибутом `path`.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=theme-resource]
----

* В Java: интерфейс `ThemeResource`:
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageResourceScreen.java[tags=image-theme]
----

[[url-resource]]
=== UrlResource

Изображение, которое может быть загружено с произвольного URL-адреса.

* В XML: элемент `url` с атрибутом `url`.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=url-resource]
----

* В Java: интерфейс `UrlResource`.
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageResourceScreen.java[tags=image-url]
----

[[resource-settings]]
=== Настройки ресурсов

* `bufferSize` - размер буфера, используемого для загрузки этого ресурса, в байтах.
* `cacheTime` - время хранения объекта в кэше в миллисекундах.
* `mimeType` - MIME-тип ресурса.

Например:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=mime]
----

[[attributes]]
== Атрибуты

[[alternate-text]]
* `alternateText` - устанавливает альтернативный текст на случай, если ресурс недоступен или не задан.

[[scale-mode]]
* `scaleMode` - устанавливает режим масштабирования изображения (соответствует CSS-свойству `object-fit`). Доступны следующие режимы:
** `FILL` - изображение масштабируется, чтобы заполнить всю область компонента: используется вся ширина и высота компонента.
** `CONTAIN` - изображение подстраивается под размер компонента с сохранением пропорций, уменьшаясь или растягиваясь по меньшей стороне компонента.
** `COVER` - изображение масштабируется так, чтобы заполнить всю область компонента, сохраняя при этом соотношения сторон. Если пропорции изображения не совпадают с пропорциями компонента, то изображение будет обрезано по размеру.
** `SCALE_DOWN` - для изображения применяется либо режим `NONE`, либо `CONTAIN`, в зависимости от того, какой режим дает меньший размер.
** `NONE` - изображение сохранит свой исходный размер.

[[methods]]
== Методы

Для программного управления компонентом `Image` следует использовать следующие методы:

* `setValueSource()` - устанавливает для изображения контейнер данных и его атрибут. Поддерживаются только атрибуты типов `FileRef` и `byte[]`.
+
Программное указание контейнера данных позволяет, к примеру, отображать изображения в ячейках таблицы:
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=data-start;collection;data-end;layout-start;group-table;layout-end]
----
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageScreen.java[tags=value-source]
----

* `setSource()` - устанавливает <<resources,ресурс>> изображения. Метод принимает тип ресурса и возвращает объект ресурса, который может быть сконфигурирован далее.
+
[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/image/image-screen.xml[tags=layout-start;programmatic-image;layout-end]
----
+
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageScreen.java[tags=set-source]
----

[[handlers]]
== События и слушатели

include::../events-hanlers-generation-tip.adoc[]

[[click-event]]
=== ClickEvent

См. xref:vcl/components/button.adoc#click-event[ClickEvent].

[[context-help-icon-click-event]]
=== ContextHelpIconClickEvent

См. xref:vcl/api.adoc#context-help-icon-click-handler[ContextHelpIconClickEvent].

[[source-change-event]]
=== SourceChangeEvent

`SourceChangeEvent` отправляется при изменении источника изображения и имеет следующие методы:

* `getNewSource()`
* `getOldSource()`

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/image/ImageScreen.java[tags=source-change-event]
----

Чтобы создать слушателя события программно, используйте метод компонента  `addSourceChangeListener()`.

[[xml]]
== Все XML-атрибуты

include::../xml-studio-tip.adoc[]

=== Image XML Attributes

xref:vcl/xml.adoc#align[align] -
<<alternate-text, alternateText>> -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#data-container[dataContainer] -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/xml.adoc#editable[editable] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#height[height] -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/xml.adoc#property[property] -
xref:vcl/xml.adoc#required[required] -
xref:vcl/xml.adoc#required-message[requiredMessage] -
xref:vcl/xml.adoc#property[property] -
xref:vcl/xml.adoc#required[required] -
xref:vcl/xml.adoc#required-message[requiredMessage] -
xref:vcl/xml.adoc#rowspan[rowspan] -
<<scale-mode, scaleMode>> -
xref:vcl/xml.adoc#stylename[stylename] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]

=== Image XML Elements

<<resources,resource>>

=== Resources XML Elements

<<resource-classpath,classpath>> -
<<resource-file,file>> -
<<resource-relative-path,relativePath>> -
<<resource-theme,theme>> -
<<resource-url,url>>