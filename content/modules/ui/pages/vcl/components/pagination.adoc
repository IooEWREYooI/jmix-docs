= Pagination

`Pagination` – это компонент, используемый для загрузки данных по страницам. Это позволяет пользователям осуществлять навигацию по большому объему данных с предсказуемой производительностью.

См. также компонент xref:vcl/components/simple-pagination.adoc[SimplePagination], который имеет другое визуальное представление и может использоваться внутри `Table`, `DataGrid` и других компонентов-списков.

XML-имя компонента: `pagination`.

== Основы

`Pagination` содержит номера страниц, что позволяет пользователю выбрать определенную страницу, и выпадающий список для выбора количества элементов на странице.

Чтобы использовать разбивку на страницы вместе с компонентом-списком, необходимо <<data-binding,привязать>> компонент `Pagination` и компонент-список к одному и тому же источнику данных.

image::vcl/components/pagination.png[align="center"]

[[data-binding]]
== Привязка к данным

Чтобы создать `Pagination`, связанный с данными, используйте вложенный элемент `containerProvider` или `loaderProvider`.

[NOTE]
====
У `Pagination` должен быть только один провайдер.
====

[[container-provider]]
=== containerProvider

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/pagination/pagination-screen.xml[tags=data-start;customers-collection;data-end;layout-start;pagination-container-provider;layout-end]
----
<1> `CollectionContainer` для сущности `Customer`.
<2> Компонент `Pagination` связан с источником данных с помощью атрибута `dataContainer` вложенного элемента `containerProvider`.

[[loader-provider]]
=== loaderProvider

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/pagination/pagination-screen.xml[tags=data-start;cities-collection;data-end;layout-start;pagination-loader-provider;layout-end]
----
<1> `citiesDl` `CollectionLoader` загружает коллекцию сущностей по JPQL-запросу.
<2> Компонент `Pagination` связан с источником данных с помощью атрибута `loaderId` вложенного элемента `loaderProvider`.

[[items-per-page]]
== Количество элементов на странице

[[items-per-page-visible]]
У `Pagination` есть специальный `ComboBox` со списком параметров для ограничения количества элементов на одной странице. Чтобы сделать его видимым, установите для атрибута `itemsPerPageVisible` значение `true`. Значение по умолчанию – `false`.

image::vcl/components/pagination-items-per-page-combo-box.png[align="center"]

[[items-per-page-options]]
Значение по умолчанию для этого списка указано в свойстве xref:app-properties.adoc#jmix.ui.component.pagination-items-per-page-options[jmix.ui.component.pagination-items-per-page-options].

Можете настроить свой список параметров, используя атрибут `itemsPerPageOptions`. Значением атрибута должен быть список параметров, разделенных запятыми:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/pagination/pagination-screen.xml[tags=items-options]
----

[NOTE]
====
Значения, меньшие или равные `0`, игнорируются; значение больше максимально допустимого количества загружаемых записей (`jmix.ui.entityMaxFetchSize`) игнорируется и заменяется максимально допустимым.
====

[[items-per-page-default-value]]
Чтобы задать значение по умолчанию из списка параметров, используйте атрибут `itemsPerPageDefaultValue`:

[source, xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/pagination/pagination-screen.xml[tags=items-options-default]
----

[[items-per-page-unlimited-option-visible]]
Атрибут `itemsPerPageUnlimitedOptionVisible` задает видимость неограниченного (`null`) значения параметра `ComboBox`. Если выбран параметр `null`, компонент попытается загрузить данные с ограничением `jmix.ui.entityMaxFetchSize`. Значение по умолчанию – `true`.

[[max-visible-pages]]
== Количество видимых страниц

Компонент `Pagination` позволяет изменять количество максимально видимых страниц с помощью атрибута `maxVisiblePages`. Страниц в компонент может быть много, но пользователи будут видеть сразу несколько страниц, в соответствии с атрибутом `maxVisiblePages`. Значение по умолчанию – `5`. Например, если установить `maxVisiblePages="3"`, будет видно только три страницы одновременно:

image::vcl/components/pagination-max-visible-pages.png[align="center"]

[[handlers]]
== События и слушатели

include::../events-hanlers-generation-tip.adoc[]

[[page-change-event]]
=== PageChangeEvent

`PageChangeEvent` отправляется, когда пользователь выбирает другую страницу или нажимает на кнопки навигации (следующая, предыдущая и т.д.).

Пример подписки на событие компонента `Pagination`, объявленного в XML с идентификатором `pagination` id:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/pagination/PaginationScreen.java[tags=page-change-event]
----

Чтобы создать слушателя события программно, используйте метод компонента `addPageChangeListener()`.

[[before-refresh-event]]
=== BeforeRefreshEvent

`BeforeRefreshEvent` отправляется перед обновлением данных, когда пользователь нажимает "следующая", "предыдущая" и т.д. Можно предотвратить обновление контейнера данных, вызвав метод `preventRefresh()`, например:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/pagination/PaginationScreen.java[tags=before-refresh-event]
----
<1> Проверьте количество экземпляров в хранилище данных.
<2> Предотвратите обновление данных.

Чтобы создать слушателя события программно, используйте метод компонента `addBeforeRefreshListener()`.

[[after-refresh-event]]
=== AfterRefreshEvent

`AfterRefreshEvent` вызывается при обновлении данных.

Пример подписки на событие компонента `Pagination`, объявленного в XML с идентификатором `paginationWithDefault`:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/pagination/PaginationScreen.java[tags=after-refresh-event]
----

Чтобы создать слушателя события программно, используйте метод компонента `addAfterRefreshListener()`.

[[total-count-delegate]]
=== TotalCountDelegate

`TotalCountDelegate` – это слушатель, который используется для получения общего количества элементов. Например:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/pagination/PaginationScreen.java[tags=total-count-delegate]
----

Чтобы создать слушателя `TotalCountDelegate` программно, используйте метод  `setTotalCountDelegate()`.

[[xml]]
== Все XML-атрибуты

include::../xml-studio-tip.adoc[]

xref:vcl/xml.adoc#align[align] -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#height[height] -
<<items-per-page-default-value,itemsPerPageDefaultValue>> -
<<items-per-page-options,itemsPerPageOptions>> -
<<items-per-page-unlimited-option-visible,itemsPerPageUnlimitedOptionVisible>> -
<<items-per-page-visible,itemsPerPageVisible>> -
<<max-visible-pages,maxVisiblePages>> -
xref:vcl/xml.adoc#rowspan[rowspan] -
xref:vcl/xml.adoc#stylename[stylename] -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]