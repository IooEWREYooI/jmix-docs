= Creating GWT Component

[[creating-custom-widgetset]]
== Creating Custom WidgetSet

Jmix framework provides a ready-compiled widgetset in the `jmix-ui-widgets-compiled` artifact.

To create a custom widgetset in the project, you need to:

. Remove `implementation 'io.jmix.ui:jmix-ui-widgets-compiled'` dependency.
. Add dependencies to your `build.gradle`:
+
[source,gradle,indent=0]
----
include::example$/ex1/build.gradle[tags=widgets-dependency]
----
<1> Required only for developing custom client-side components.

. Add the `compileWidgets` task (change paths according to your application base package):
+
[source,gradle,indent=0]
----
include::example$/ex1/build.gradle[tags=compile-widgets]
----
+
[NOTE]
====
The `excludePaths` parameter for the `compileWidgets` task is useful if you don't want to compile a widgetset in case, for example, some screen is changed.

See the example:
[source,gradle,indent=0]
----
compileWidgets {
    generate 'com.company.demo.widgets.CustomWidgetSet'
    excludePaths('**/com/company/demo/**')
}
----

In order to prevent widgetset re-compilation, the `includePaths` parameter should be added to the `compileWidgets` task.

See the example:
[source,gradle,indent=0]
----
compileWidgets {
    generate 'com.company.demo.widgets.CustomWidgetSet'
    includePaths('**/io/jmix/**/widget/**', '**/com/company/demo/widgets/**')
}
----

`includePaths` prevents re-compilation only issued by source code changes. If you see unexpected re-compilation, check the particular reason (execute `compileWidgets` with the `--info` param).

The `excludePaths` and `includePaths` parameters accept the list of exclude and include patterns, respectively. For pattern rules see: https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/util/PatternFilterable.html[^].
====
. Add the `jmix.ui.widget-set` property to your `application.properties` file (adjust location according to the `compileWidgets` task above):
+
[source,properties,indent=0]
----
include::example$/ex1/src/main/resources/application.properties[tags=widget-set]
----

Widgetsets are compiled by the `WidgetsCompile` task named `compileWidgets`. It is automatically created when using the Jmix plugin.

The compiled widgetset is placed in the `build/widgets` directory and will be included in the JAR/WAR artifact of the project.

[[color-button-gwt-component]]
== Creating ColorButton GWT Component

In this section, we will create a custom `ColorButton` component. This component is directly inherited from the `JmixButton` component.

Custom UI components (that is, components directly inherited from Vaadin components) should be placed in the `widgets` subpackage, for example, `com.company.sample.widgets`. Clients-side components (connectors and widgets), as well as classes used for server-side and client-side communication, such as RPC and State, should be placed in the `widgets.client` subpackage, for example `com.company.sample.widgets.client`.

[[component-state-class]]
=== Creating Component State Class

Create `ColorButtonState.java` within the `widgets.client` package.

The `ColorButtonState` state class defines what data is sent between the client and the server. It contains public fields that are automatically serialized on the server-side and deserialized on the client.

.ColorButtonState.java
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/widgets/client/ColorButtonState.java[tags=color-button-state]
----

[[vaadin-component-class]]
=== Creating Vaadin Component Class

`ColorButton` is a Vaadin component class. It can define an API for the server code, accessor methods, event listeners, and data sources connection. Developers use the methods of this class in the application code.

Create `ColorButton.java` within the `widgets` package:

.ColorButton.java
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/widgets/ColorButton.java[tags=color-button]
----

[[connector]]
=== Creating Connector

Create `ColorButtonConnector.java` within the `widgets.client` package.

The `ColorButtonConnector` connector links client code with the server.

.ColorButtonConnector.java
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/widgets/client/ColorButtonConnector.java[tags=color-button-connector]
----

[[using-color-button]]
=== Using ColorButton

To demonstrate how the component works, letâ€™s create a new `color-button-screen` screen.

Open the `ColorButtonScreen.java` screen controller and add the code that puts the component to the screen:

.ColorButtonScreen.java
[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/components/colorbutton/ColorButtonScreen.java[tags=color-button-screen]
----

The picture below shows the project structure:

image::custom-components/project-structure.png[align="center"]

Start the application and see the result:

image::custom-components/color-button.png[align="center"]