= 导出透视表数据

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=pivottable-data-export" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`PivotTableExtension` 是 `PivotTable` 组件的扩展，提供带有聚合数据的表格下载 API，下载格式为 XLS。

需要使用构造函数在界面控制器中创建此扩展的实例。示例：

[source,java,indent=0]
----
include::example$/ex1/src/main/java/pivottable/ex1/screen/PivotTableExport.java[tags=export;extension;init]
----

TIP: 该扩展仅适用于以下 xref:pivot-table:elements.adoc#renderers[渲染器] 类型：`TABLE`、`TABLE_BAR_CHART`、`HEATMAP`、`COL_HEATMAP`、`ROW_HEATMAP`，并且不能获取单元格的颜色。

可以使用 `exportTableToXls()` 方法下载 XLS 格式的表格数据，例如，在点击按钮时：

[source,java,indent=0]
----
include::example$/ex1/src/main/java/pivottable/ex1/screen/PivotTableExport.java[tags=extension;button1;button2]
----

默认情况下，下载文件名与 `PivotTable` 数据容器中实体的本地化名称一致。也可以使用 `setFileName()` 方法定义文件名：

[source,java,indent=0]
----
include::example$/ex1/src/main/java/pivottable/ex1/screen/PivotTableExport.java[tags=set-file-name]
----

TIP: XLS 格式的文件最多只能存 65536 行数据。如果 `PivotTable` 包含多于 65536 行，那么表格内容只能导出到限制的最后一行，系统也会弹出相应的警告信息。

另外，`PivotTableExtension` 提供了另外两个获取 `PivotTable` 数据的方法：

* `extension.getPivotDataJSON()` - 获取 JSON 格式的数据。
* `extension.getPivotData()` - 获取序列化的 `PivotData` 对象。
