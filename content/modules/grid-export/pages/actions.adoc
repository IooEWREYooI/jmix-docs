= 导出操作

`ExportAction` 是一个基本 xref:ui:actions/standard-actions.adoc#list-actions[列操作]，使用定义的导出器导出表格的内容。此操作需要一个 xref:exporters.adoc[TableExporter] 实例。

此操作只可用于列表组件（xref:ui:vcl/components/table.adoc[Table]、xref:ui:vcl/components/group-table.adoc[GroupTable]、xref:ui:vcl/components/tree-table.adoc[TreeTable]、xref:ui:vcl/components/data-grid.adoc[DataGrid]、xref:ui:vcl/components/tree-data-grid.adoc[TreeDataGrid]、xref:ui:vcl/components/tree.adoc[Tree]）。

`ExportAction` 提供方法用于管理获取 `Table` 或 `DataGrid` 列值的方法。

* `addColumnValueProvider()` 添加一个方法，用于从列中获取值。
* `removeColumnValueProvider()` 删除一个获取列值的方法。

`ExportAction` 有两种导出模式：所有行或选中行。如果没有选中行，则默认导出所有行。

image::export-action.png[align="center"]

可以通过在 xref:localization:message-bundles.adoc[消息包] 添加 `actions.exportSelectedTitle` 和 `actions.exportSelectedCaption` 消息覆盖默认的弹窗标题和消息。

[[custom-action]]
== 自定义导出操作

可以通过继承 `ExportAction` 自定义操作。

下面示例创建自定义导出操作：

[source,java,indent=0]
----
include::example$/ex1/src/main/java/gridexport/ex1/screen/exporter/CustomExportAction.java[tags=my-custom-action]
----
<1> 如果需要，你可以使用 xref:exporters.adoc#custom-exporter[自定义] 表格导出器。

现在可以在界面控制器使用该操作：

[source,java,indent=0]
----
include::example$/ex1/src/main/java/gridexport/ex1/screen/customer/CustomerBrowse.java[tags=actions;application-context;customers-table;custom-btn;on-init-start;custom-action;on-init-end]
----

[[excel-export-action]]
== ExcelExportAction

// TODO add XLS format mention in case https://github.com/jmix-framework/jmix/issues/429 is fixed. Now there is no API to select XLS.

`ExcelExportAction` 操作继承了 xref:actions.adoc[ExportAction] 用于以 XLSX 格式导出表格内容。

此操作由 `io.jmix.uiexport.action.ExcelExportAction` 类实现，在 XML 中的列表组件，需要使用 `type="excelExport"` 操作属性进行定义。可以使用 `action` 元素的属性配置通用的操作参数。参阅 xref:ui:actions/declarative-actions.adoc[声明式定义操作] 了解详情。

示例：

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/gridexport/ex1/screen/customer/customer-browse.xml[tags=actions-start;action-excel;actions-end]
----

或者，可以在界面控制器注入该操作，然后用 setter 配置：

[source,java,indent=0]
----
include::example$/ex1/src/main/java/gridexport/ex1/screen/customer/CustomerBrowse.java[tags=customers-table-excel-export;on-init-start;set-caption;on-init-end]
----

你可以覆盖本地化的数据格式字符串。Excel 导出的默认格式字符串定义如下：

[source,properties]
----
include::example$/ex1/src/main/resources/gridexport/ex1/messages.properties[tags=excel-exporter-defaults]
----

[CAUTION]
====
XLS 格式只支持最多 65536 行表格数据。如果导出的表格包含超过 65536 行的数据，超出的数据将不会导出，这里也会弹出警告消息。
====

[[json-export-action]]
== JsonExportAction

`JsonExportAction` 操作继承了 xref:actions.adoc[ExportAction] 用于以 JSON 格式导出表格内容。

此操作由 `io.jmix.uiexport.action.JsonExportAction` 类实现，在 XML 的列表组件中，需要使用 `type="jsonExport"` 操作属性进行定义。可以使用 `action` 元素的属性配置通用的操作参数。参阅 xref:ui:actions/declarative-actions.adoc[声明式定义操作] 了解详情。

示例：

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/gridexport/ex1/screen/customer/customer-browse.xml[tags=actions-start;action-json;actions-end]
----

或者，可以在界面控制器注入该操作，然后用 setter 配置：

[source,java,indent=0]
----
include::example$/ex1/src/main/java/gridexport/ex1/screen/customer/CustomerBrowse.java[tags=customers-table-json-export;on-init-start;set-caption-json;on-init-end]
----
