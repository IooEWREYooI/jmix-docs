= 界面设计器

界面设计器有许多面板和工具窗口，为界面布局开发提供支持，以所见即所得的形式设置 UI 组件属性。界面 xref:ui:screens/descriptors.adoc[XML 描述] 编辑器与界面设计器集成，因此，可以直接编辑 XML 文件或使用设计器的面板生成代码。

include::subscription-note.adoc[]

<<component-hierarchy,Component Hierarchy（组件层级结构）>>、<<component-palette,Component Palette（组件工具箱）>> 和 <<component-inspector,Component Inspector（组件探查器）>> 都作为 IDE 中独立的工具窗口提供。当在编辑器打开界面描述时，会自动展示。

image::screen-designer.png[align="center"]

. Component Inspector（组件探查器）
. Component Hierarchy（组件层级结构）
. Component Palette（组件工具箱）
. 顶部操作按钮
. 布局预览面板
. 布局预览

[[layout-preview-panel]]
== 布局预览面板

布局预览面板用于展示界面布局的交互式示意图。与屏幕描述的源代码共享编辑器空间。

image::screen-views.png[align="center"]

界面布局编辑器右上角的按钮：

. *Editor only* - 仅在编辑器展示源代码。
. *Editor and Preview* - 编辑器空间分为两部分，分别展示源码和预览。
. *Preview only* - 仅在编辑器展示预览。
. *Preview in Window* - 在编辑器展示源码，预览在单独窗口展示。

面板的右上角还有几个控制按钮：

image::screen-view-panel.png[align="center"]

* *100% x 100%* 下拉列表允许选择固定画布大小。画布大小可以大于预览面板的大小，此时，将显示滚动条。例如，如果你正在开发包含大量控件的复杂界面，并且想要查看预览，则可以选择 1920x1080 画布大小并观察布局在大屏幕中的展示情况。
* *Refresh* 按钮重新加载预览页面的内容。
* *Zoom In*、*Zoom Out* 和 *Zoom Reset* 按钮改变预览页面的缩放比例。

此外，还可以使用控件来调整布局中组件的大小和对齐：

image::screen-expand.png[align="center"]

[[component-palette]]
== 组件工具箱

*Component Palette（组件工具箱）* 窗口展示一组可用的界面元素：xref:ui:vcl/components.adoc[界面组件]、xref:ui:vcl/containers.adoc[布局容器]、xref:ui:data-components.adoc[数据组件] - 数据容器和加载器、xref:ui:facets.adoc[界面 facets] 包含操作和对话框模式设置。

image::screen-palette.png[align="center"]

可以使用搜索框查找需要的组件。

如果应用程序中安装的扩展组件包含其自有的组件，也会在工具箱展示，例如，对于图表扩展组件：

image::screen-charts.png[align="center"]

如需将组件添加至布局中，将其从工具箱拖放至 XML 源码中合适的位置或放置于 <<component-hierarchy,Component Hierarchy（组件层级结构）>> 面板中。

image::screen-move.gif[align="center"]

右键点击工具箱中的组件可以打开右键菜单，其中有下列操作：

* *Add to Design* - 将选中的组件添加至界面，放置于界面结构中选中的元素内。
* *Jmix Documentation* - 打开组件的文档页面。

[[component-hierarchy]]
== 组件层级结构

*Component Hierarchy（组件层级结构）* 工具窗口展示不居中组件的树结构。

可以从 *Component Palette（组件工具箱）* 窗口移动组件至层级结构中，或者重新调整树中组件的位置。当选中树的元素时，*Component Inspector（组件探查器）* 窗口展示选中元素的属性。

右键点击元素可以看到右键菜单中的操作：

image::screen-hierarchy.png[align="center"]

* *Convert to* - 将组件转换为其他类似的组件。
* *Wrap into* - 将组件放置在某个推荐的布局容器内。
* *Go to XML* - 打开源代码中组件的 XML 标签位置。
* *Inject to Controller* - 将组件注入界面控制器或跳转至代码中已经存在的注入声明位置。 
* 对元素的 *Delete*、*Copy*、*Cut* 或 *Paste* 操作。
* 打开所选组件的 Jmix 文档页。

[[component-inspector]]
== 组件探查器

*Component Inspector（组件探查器）* 工具窗口有 *Properties（属性）* 和 *Handlers（处理器）* 标签页。

[[component-inspector-add-button]]
对于某些选中的元素，会展示 *+ Add* 按钮，可以用来添加子元素，例如表格操作、列、格式化器、验证器等。

image::component-inspector-add-button.png[align="center", width="275"]

[[add-picker-action]]
* 如需添加一个 xref:ui:actions/standard-actions.adoc#picker-actions[选取器组件操作]，在界面 XML 描述或者 *Component Hierarchy* 中选择一个选取器组件（xref:ui:vcl/components/entity-combo-box.adoc[EntityComboBox]、xref:ui:vcl/components/entity-picker.adoc[EntityPicker]、xref:ui:vcl/components/entity-suggestion-field.adoc[EntitySuggestionField]、xref:ui:vcl/components/value-picker.adoc[ValuePicker]），然后点击 *Component Inspector* 中的 *Add → Action*。此时会显示 *Add Action* 弹窗：
+
image::add-picker-action-dialog.png[align="center", width="492"]
+
从列表中选择一些标准操作。
+
如需添加自定义的 xref:ui:actions/declarative-actions.adoc[声明式操作]，选择 *New Custom Action* 并点击 *OK*。显示 *Enter Action Id* 对话框：
+
image::action-id-dialog.png[align="center", width="343"]
+
然后通过订阅 `Action.ActionPerformedEvent` 事件，在 xref:ui:screens/screen-controllers.adoc[界面控制器] 实现自定义的逻辑。

[[add-action]]
* 如需添加 xref:ui:actions/standard-actions.adoc#list-actions[列表操作]，在界面 XML 描述或者 *Component Hierarchy* 中选择一个 `table` 或 `dataGrid` 组件，然后点击 *Component Inspector* 中的 *Add → Action*。此时会显示 *Add Action* 弹窗：
+
image::add-action-dialog.png[align="center", width="492"]
+
如果选择了 *Create Button for selected actions* 复选框，Jmix Studio 会在 `buttonsPanel` 布局容器中创建一个 `button`，关联至添加的操作。

[[add-column]]
* 如需添加 `column`，在界面 XML 描述或者 *Component Hierarchy* 中选择 `columns` 元素，然后点击 *Component Inspector* 中的 *Add → Column*。此时会显示 *Add Column* 弹窗：
+
image::add-column-dialog.png[align="center", width="386"]
+
列表展示 xref:data-access:fetching.adoc#fetch-plan[fetchPlan] 中包含的那些还没有在 `table` 组件展示的属性。
+
如需添加一个 xref:ui:vcl/components/data-grid.adoc#data-grid-column-generation[生成列]，选择 *New Custom Column* 并点击 *OK*。此时会显示 *Column generator* 弹窗：
+
image::column-generator.png[align="center", width="431"]
+
从 Studio 建议的列表中选择一个生成列的类型及其对应的 xref:ui:vcl/components/data-grid.adoc#renderers[渲染器] 类型。
+
Studio 会自动在 XML 中添加生成列，在界面控制器中添加处理器方法。

[[properties-tab]]
=== Properties 标签页

*Properties* 标签页展示选中界面元素的属性，并支持编辑。

image::screen-properties.png[align="center"]

有些属性具有默认值，以灰色显示。

使用搜索控件查找需要的属性。

属性默认按照名称排序。第一列给出所选组件的所有属性名。第二列展示属性值：

*  当选中某个属性时，值会变为一个可编辑的字段，允许输入新值。
+
image::text-values.gif[align="center"]

* 如果值是一个列表，则选中该属性时会显示一个 image:moveDown.png[下移] 下拉按钮。
+
image::list-values.gif[align="center"]

* 如果值是布尔类型，可以用复选框修改：
+
image::boolean-values.gif[align="center"]

[[localized-message-dialog]]
* 类似 xref:ui:vcl/xml.adoc#caption[caption]、xref:ui:vcl/xml.adoc#description[description]、xref:ui:vcl/xml.adoc#context-help-text[contextHelpText] 这样的属性，可以设置 xref:localization:index.adoc[本地化] 内容。点击 image:main-message-pack.png[地球仪] 按钮展示本地化信息输入的弹窗。
+
image::message-values.gif[align="center"]

[[style-name-editor]]
* 点击 xref:ui:vcl/xml.adoc#stylename[stylename] 属性的 image:plus-button.png[Plus] 按钮打开 *Style Name Editor* 对话框：
+
image::style-name-editor.png[align="center"]
+
样式名称按照组件或容器名排序。

[[icon-editor]]
* 点击 xref:ui:vcl/xml.adoc#icon[icon] 属性的 image:edit.png[Edit] 按钮打开 *Choose icon* 对话框：
+
image::choose-icon-dialog.png[align="center"]
+
** *JMIX ICONS* 标签页包含默认的 `JmixIcon` 图标集。几乎包含全部的 `FontAwesome` 图标集以及 Jmix 特定的图标。
** *FONT AWESOME* 标签页包含 `FontAwesome` 字体图标集。
** *ICON SET* 标签页包含 xref:ui:icons/icon-sets.adoc[自定义图标集]。
** *APPLICATION ICONS* 标签页包含 xref:ui:themes.adoc[主题] 资源。

[[handlers-tab]]
=== Handlers 标签页

*Handlers（处理器）* 标签页展示选中组件的事件监听器和组件代理方法。如需生成处理器方法，双击相应的行即可。

image::screen-handlers.png[align="center"]

然后会自动跳转至 xref:ui:screens/screen-controllers.adoc[界面控制器] 中代码段的位置。

[[top-actions-panel]]
== 顶部操作面板

操作面板位于源码编辑器的顶部。提供下列操作：

* *Controller* - 跳转至界面控制器。
* `<entity class name>` - 如果界面是实体浏览界面或者编辑界面，则展示实体类名称，可以跳转至当前界面关联的实体代码。

image::screen-top-panel.png[align="center"]

此外，还可以点击侧边线的标记在控制器和界面描述之间切换。
